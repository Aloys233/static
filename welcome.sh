#!/bin/bash
# /usr/local/bin/welcome.sh
# 彩虹渐变大字（一次性输出，非逐行打印）

clear

# 彩虹渐变颜色（每行一种颜色）
COLORS=(
  "\e[38;2;255;0;0m"     # 红
  "\e[38;2;255;127;0m"   # 橙
  "\e[38;2;255;255;0m"   # 黄
  "\e[38;2;0;255;0m"     # 绿
  "\e[38;2;0;0;255m"     # 蓝
  "\e[38;2;139;0;255m"   # 紫
)
RESET="\e[0m"

# 大字图案
ASCII_ART=(
"   █████████   ████                               ████████   ████████ "
"  ███░░░░░███ ░░███                              ███░░░░███ ███░░░░███"
" ░███    ░███  ░███   ██████  █████ ████  █████ ░░░    ░███░░░    ░███"
" ░███████████  ░███  ███░░███░░███ ░███  ███░░     ███████    ██████░ "
" ░███░░░░░███  ░███ ░███ ░███ ░███ ░███ ░░█████   ███░░░░    ░░░░░░███"
" ░███    ░███  ░███ ░███ ░███ ░███ ░███  ░░░░███ ███      █ ███   ░███"
" █████   █████ █████░░██████  ░░███████  ██████ ░██████████░░████████ "
"░░░░░   ░░░░░ ░░░░░  ░░░░░░    ░░░░░███ ░░░░░░  ░░░░░░░░░░  ░░░░░░░░  "
"                               ███ ░███                               "
"                              ░░██████                                "
"                               ░░░░░░                                  "
)

# 先采集系统信息（避免中途打印），最后一次性输出
CPU=$(top -bn1 | grep "Cpu(s)" | awk '{print $2+$4}')
MEM=$(free -h | awk '/Mem:/ {print $3 "/" $2}')
DISK=$(df -h / | awk 'NR==2 {print $3 "/" $2 " used (" $5 ")"}')
UPTIME=$(uptime -p)

# 构建输出缓冲区
buf=""
for i in "${!ASCII_ART[@]}"; do
  color=${COLORS[$((i % ${#COLORS[@]}))]}
  buf+="${color}${ASCII_ART[$i]}${RESET}\n"
done

buf+="\n\e[36m================= System Status =================\e[0m\n"
buf+="CPU Usage: \e[33m${CPU}%\e[0m\n"
buf+="Memory Usage: \e[32m${MEM}\e[0m\n"
buf+="Disk Usage: \e[34m${DISK}\e[0m\n"
buf+="Uptime: \e[35m${UPTIME}\e[0m\n"
buf+="\e[36m=================================================\e[0m\n"

# 一次性打印，图案“瞬间”出现
printf "%b" "$buf"
